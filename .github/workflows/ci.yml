# This file is automatically generated by terraform. I hope it's
# readable, but please don't edit it.

"jobs":
  "can_enqueue":
    "if": "always() && github.event_name != 'merge_group'"
    "needs":
    - "ci_go"
    "permissions":
      "actions": "read"
    "runs-on": "ubuntu-latest"
    "steps":
    - "env":
        "NEEDS_JSON": "${{toJSON(needs)}}"
      "name": "Transform outcomes"
      "run": |
        echo "ALL_SUCCESS=$(echo "$NEEDS_JSON" | jq '. | to_entries | map([.value.result == "success", .value.result == "skipped"] | any) | all')" >>$GITHUB_ENV
    - "name": "check"
      "run": "[ $ALL_SUCCESS == true ]"
  "can_merge":
    "if": "always() && github.event_name == 'merge_group'"
    "needs":
    - "ci_go"
    - "docker-publish"
    "permissions":
      "actions": "read"
    "runs-on": "ubuntu-latest"
    "steps":
    - "env":
        "NEEDS_JSON": "${{toJSON(needs)}}"
      "name": "Transform outcomes"
      "run": |
        echo "ALL_SUCCESS=$(echo "$NEEDS_JSON" | jq '. | to_entries | map([.value.result == "success", .value.result == "skipped"] | any) | all')" >>$GITHUB_ENV
    - "name": "check"
      "run": "[ $ALL_SUCCESS == true ]"
  "can_see_status":
    "runs-on": "ubuntu-latest"
    "steps":
    - "name": "Immediate success for improved visibility on github merge queue"
      "run": "true"
  "ci_go":
    "secrets": "inherit"
    "uses": "./.github/workflows/ci_go.yml"
  "docker-publish":
    "secrets": "inherit"
    "uses": "./.github/workflows/docker-publish.yml"
"name": "CI"
"on":
  "merge_group": {}
  "pull_request":
    "branches": "main"
  "push":
    "branches":
    - "main"
  "workflow_dispatch": {}
"permissions":
  "contents": "read"
  "id-token": "write"
  "packages": "write"
